---
layout:     post                                  # 使用的布局（不需要改）
title:      《Linux 内核设计的艺术》学习笔记        # 标题 
subtitle:   当年学操作系统欠下的都是要还的……        # 副标题
date:       2022-11-16                     # 时间
author:     WYX                         # 作者
header-img: img/post-bg-badlands-national-park.jpg         # 这篇文章的标题背景图片
catalog: true                             # 是否归档
tags:                                    # 标签
    - 操作系统
    - 毕业设计
---

# 《Linux 内核设计的艺术》学习笔记

> 2022/11/16：感觉这种大砖头书一刷不太够，经常看不懂，回头再二刷

## 第一章

- 开机上电硬件启动 BIOS（此时为 16 位实模式

- BIOS 执行：
  
  - 加载中断向量表和中断服务程序
  
  - 调中断 int 0x19 加载第一扇区 bootsect.s（引导程序）
  
  - 加载四个扇区和扇区内容到内存

- bootsect.s 执行：
  
  - 调中断 int 0x13 加载 setup.s 程序到内存
  
  - 调中断 int 0x13 加载 system.s 程序到内存

- setup.s 执行：
  
  - 读机器系统数据
  
  - 关中断，将 system 移动到内存起始（覆盖 BIOS 中断 ）
  
  - 设置中断描述符表和全局描述符表，将专用寄存器指向表
  
  - 打开 A20 实现 32 位寻址
  
  - 重编程两块 8259 芯片将 CPU 工作模式设为保护模式

- head.s 执行：
  
  - 将寄存器转换为保护模式，设置页表，跳入 main.c 程序

## 第二章

- main.c 执行：
  
  - 设置进程管理数据结构，如进程槽 task[]，进程的 task_struct, 等
  
  - 复制根设备号、硬盘参数表
  
  - 根据物理内存大小规划使用
  
  - 设置外设虚拟盘
  
  - 初始化内存管理结构
  
  - 挂接异常处理中断
  
  - 准备使进程 0 能在 32 位保护模式下工作
    
    - 初始化块设备请求项管理 request[] 
    
    - 挂接串行口、键盘、显示器中断
    
    - 设置开机启动时间
  
  - 创建进程 0
  
  - 进程 0 执行：
    
    - 挂接进程 0 的数据结构和全局描述符表
    
    - 设置时钟中断
    
    - 挂接 system_call 和中断描述符表
    
    - 从内核态转换到用户态，调用 fork() 函数创建进程 1 
    
    - 在进程槽 task[] 为进程 1 申请空间
    
    - 复制进程信息、管理结构 task_struct 到进程 1
    
    - 设置进程 1 的线性地址空间、物理页面
    
    - 调用系统中断 pause() 切换到进程 1
  
  - 进程 1 执行：
    
    - 设置硬盘管理相关数据结构
    
    - 用虚拟盘代替软盘作为根设备
    
    - 用虚拟盘中的数据加载根文件系统
    
    - 
  
  - 进程 1 执行：
  
  - 准备使进程 1 能和外设数据交互
  
  - 用进程 1 创建进程 2
  
  - 进程 2 构建 shell 界面支持用户和计算机交互

## 第三章
